(function(e){function t(t){for(var n,r,a=t[0],c=t[1],l=t[2],h=0,p=[];h<a.length;h++)r=a[h],i[r]&&p.push(i[r][0]),i[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);u&&u(t);while(p.length)p.shift()();return s.push.apply(s,l||[]),o()}function o(){for(var e,t=0;t<s.length;t++){for(var o=s[t],n=!0,a=1;a<o.length;a++){var c=o[a];0!==i[c]&&(n=!1)}n&&(s.splice(t--,1),e=r(r.s=o[0]))}return e}var n={},i={demo:0},s=[];function r(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=n,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var u=c;s.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("848b")},"09d4":function(e,t,o){},"0d20":function(e,t,o){"use strict";var n=o("dfa5"),i=o.n(n);i.a},1401:function(e,t,o){"use strict";function n(e){e&&e.call&&e.call()}t["a"]={callFunc:n}},"28da":function(e,t,o){"use strict";o("7f7f"),o("63d9"),o("28a5"),o("a481");function n(e){var t=0;function o(e){var o=parseInt(t/500);if(!(o<=1)){for(var n in console.log("模型过大,调整模型缩小"+o+"倍"),console.time("OBJLoaderParse.js: resize obj"),e)e[n]/=o;console.timeEnd("OBJLoaderParse.js: resize obj")}}e.OBJLoader.prototype.parse=function(n,i){t=0,"undefined"===typeof i&&(i=!0),i&&console.time("OBJLoader");var s=this._createParserState();-1!==n.indexOf("\r\n")&&(n=n.replace(/\r\n/g,"\n")),-1!==n.indexOf("\\\n")&&(n=n.replace(/\\\n/g,""));for(var r=n.split("\n"),a="",c="",l="",u=0,h=[],p="function"===typeof"".trimLeft,d=0,g=r.length;d<g;d++)if(a=r[d],a=p?a.trimLeft():a.trim(),u=a.length,0!==u&&(c=a.charAt(0),"#"!==c&&"v"===c&&(l=a.charAt(1)," "===l&&null!==(h=this.regexp.vertex_pattern.exec(a))))){var f=function(e){var o=Math.abs(e);return t<o&&(t=o),e};s.vertices.push(f(parseFloat(h[1])),parseFloat(h[2]),parseFloat(h[3]))}o(s.vertices);for(var m=0,b=r.length;m<b;m++)if(a=r[m],a=p?a.trimLeft():a.trim(),u=a.length,0!==u&&(c=a.charAt(0),"#"!==c))if("v"===c)l=a.charAt(1)," "===l||("n"===l&&null!==(h=this.regexp.normal_pattern.exec(a))?s.normals.push(parseFloat(h[1]),parseFloat(h[2]),parseFloat(h[3])):"t"===l&&null!==(h=this.regexp.uv_pattern.exec(a))?s.uvs.push(parseFloat(h[1]),parseFloat(h[2])):this.onError("Unexpected vertex/normal/uv line: '"+a+"'"));else if("f"===c)null!==(h=this.regexp.face_vertex_uv_normal.exec(a))?s.addFace(h[1],h[4],h[7],h[10],h[2],h[5],h[8],h[11],h[3],h[6],h[9],h[12]):null!==(h=this.regexp.face_vertex_uv.exec(a))?s.addFace(h[1],h[3],h[5],h[7],h[2],h[4],h[6],h[8]):null!==(h=this.regexp.face_vertex_normal.exec(a))?s.addFace(h[1],h[3],h[5],h[7],void 0,void 0,void 0,void 0,h[2],h[4],h[6],h[8]):null!==(h=this.regexp.face_vertex.exec(a))?s.addFace(h[1],h[2],h[3],h[4]):this.onError("Unexpected face line: '"+a+"'");else if("l"===c){var v=a.substring(1).trim().split(" "),w=[],y=[];if(-1===a.indexOf("/"))w=v;else for(var x=0,L=v.length;x<L;x++){var M=v[x].split("/");""!==M[0]&&w.push(M[0]),""!==M[1]&&y.push(M[1])}s.addLineGeometry(w,y)}else if(null!==(h=this.regexp.object_pattern.exec(a))){var k=(" "+h[0].substr(1).trim()).substr(1);s.startObject(k)}else if(this.regexp.material_use_pattern.test(a))s.object.startMaterial(a.substring(7).trim(),s.materialLibraries);else if(this.regexp.material_library_pattern.test(a))s.materialLibraries.push(a.substring(7).trim());else if(null!==(h=this.regexp.smoothing_pattern.exec(a))){var O=h[1].trim().toLowerCase();s.object.smooth="1"===O||"on"===O;var j=s.object.currentMaterial();j&&(j.smooth=s.object.smooth)}else{if("\0"===a)continue;this.onError("Unexpected line: '"+a+"'")}s.finalize();var T=new e.Group;T.materialLibraries=[].concat(s.materialLibraries);for(var _=0,S=s.objects.length;_<S;_++){var E=s.objects[_],C=E.geometry,A=E.materials,P="Line"===C.type;if(0!==C.vertices.length){var F=new e.BufferGeometry;F.addAttribute("position",new e.BufferAttribute(new Float32Array(C.vertices),3)),C.normals.length>0?F.addAttribute("normal",new e.BufferAttribute(new Float32Array(C.normals),3)):F.computeVertexNormals(),C.uvs.length>0&&F.addAttribute("uv",new e.BufferAttribute(new Float32Array(C.uvs),2));for(var B=[],z=0,V=A.length;z<V;z++){var R=A[z],N=void 0;if(null!==this.materials&&(N=this.materials.create(R.name),P&&N&&!(N instanceof e.LineBasicMaterial))){var W=new e.LineBasicMaterial;W.copy(N),N=W}N||(N=P?new e.LineBasicMaterial:new e.MeshPhongMaterial,N.name=R.name),N.shading=R.smooth?e.SmoothShading:e.FlatShading,B.push(N)}var D=void 0;if(B.length>1){for(var U=0,H=A.length;U<H;U++){var I=A[U];F.addGroup(I.groupStart,I.groupCount,U)}var G=new e.MultiMaterial(B);D=P?new e.LineSegments(F,G):new e.Mesh(F,G)}else D=P?new e.LineSegments(F,B[0]):new e.Mesh(F,B[0]);D.name=E.name,T.add(D)}}return i&&console.timeEnd("OBJLoader"),T}}var i=n;function s(e,t){function o(e){this.map=e.map,this.specular=e.specular,this.shininess=e.shininess}e.MTLLoader.MaterialCreator.prototype.createMaterial_=function(n){var i=this,s=null,r=this.materialsInfo[n],a={name:n,side:this.side};for(var c in r){var l=r[c];switch(c.toLowerCase()){case"kd":a["diffuse"]=(new e.Color).fromArray(l);break;case"ka":a["ambient"]=(new e.Color).fromArray(l);break;case"ks":a["specular"]=(new e.Color).fromArray(l);break;case"map_kd":a["map"]=this.loadTexture(this.baseUrl+l,null,function(e){s?(i.materials[n].map=s.map,i.materials[n].specular=s.specular,i.materials[n].shininess=s.shininess,i.materials[n].needsUpdate=!0,t&&t.configPLight()):s=!0}),a["map"].wrapS=this.wrap,a["map"].wrapT=this.wrap;break;case"ns":a["shininess"]=l;break;case"d":l<1&&(a["transparent"]=!0,a["opacity"]=l);break;default:break}}return a["diffuse"]&&(a["ambient"]||(a["ambient"]=a["diffuse"]),a["color"]=a["diffuse"]),this.materials[n]=new e.MeshPhongMaterial(a),s||(s=new o(this.materials[n]),this.materials[n].map=null,this.materials[n].specular=new e.Color(.0667,.0667,.0667),this.materials[n].shininess=30),this.materials[n]}}var r=s,a=o("5a89"),c=o("e153");function l(e){c(a),i(a),r(a,e),this.objLoader=new a.OBJLoader,this.context=e;var t=this;t.objLoader.load=function(e,o,n){var i=this,s={size:[],isBasic:!1};t.loadMTL(o,function(t){var o=new a.FileLoader(i.manager);o.load(e,function(e){s.obj=i.parse(e),s.textureMat=t,n(s)})}),t.objLoader.onError=function(e){console.error(e)}}}o("ebc3"),l.prototype.loadMTL=function(e,t){var o=new a.MTLLoader(e.substr(0,Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"))+1));o.load(e,function(e){var o=e;o.preload(),t(o)})},l.prototype.loadOM=function(e,t,o){this.objLoader.load(e,t,o)};t["a"]=l},"349b":function(e,t,o){"use strict";var n=o("09d4"),i=o.n(n);i.a},4225:function(e,t,o){},"541e":function(e,t,o){"use strict";o("7f7f");var n=o("5a89");function i(e,t){this.blankMat=null,this.context=e;var o=this,i=new n.MTLLoader;i.load("",function(e){o.blankMat=e,t&&t.call&&t()})}function s(e,t,o){function i(n){if(n&&n.name){var i=(e.settings.showTexture?o.textureMat:t).create(n.name);return i.setValues({wireframe:!!e.settings.showWire}),i}return n}o.obj.traverse(function(e){if(e instanceof n.Mesh)if(e.material instanceof Array)for(var t in e.material)e.material[t]=i(e.material[t]);else e.material=i(e.material)}),e.configPLight()}i.prototype.mixinTexture=function(e){var t=e&&e.obj;t&&!e.hide&&s(this.context,this.blankMat,e)},t["a"]=i},"7ff8":function(e,t,o){"use strict";var n=o("4225"),i=o.n(n);i.a},"80b8":function(e,t,o){"use strict";var n=o("5a89");function i(e){this.context=e}function s(e){if(!(e.size.x>0)){var t=new n.BoundingBoxHelper(e.obj,16711680);t.update(),window.console.log("box radius: "+t.geometry.boundingSphere.radius),e.size.x=t.geometry.attributes.position.array[0]-t.geometry.attributes.position.array[3],e.size.y=t.geometry.attributes.position.array[1]-t.geometry.attributes.position.array[7],e.size.z=t.geometry.attributes.position.array[2]-t.geometry.attributes.position.array[14],window.console.log(e.size)}}i.prototype.bestLook=function(e){var t=this.context,o=e||t.getBasicMesh()||1===t.meshKeys().length&&t.meshs[t.meshKeys()[0]];if(o){o.obj.rotation.z=0,t.controls.reset(),t.camera.position.z=0,t.camera.position.y=0,s(o);var n=Math.max(o.size.x,o.size.y,o.size.z)/2*(1+Math.sqrt(5));n&&(t.camera.position.x=n),window.console.log("sceneRadiusForCamera： "+n),t.camera.lookAt(o.obj.position)}},i.prototype.bestPosition=function(){var e=this.context,t=e.getBasicMesh();if(t){var o=new n.Vector3(0,1,0);t.obj.rotateOnAxis(o,90*Math.PI/180),s(t);var i=new n.BoundingBoxHelper(t.obj,16711680);i.update(),t.obj.position.x=-i.geometry.attributes.position.array[3]-t.size.x/2,t.obj.position.y=-i.geometry.attributes.position.array[7]-t.size.y/2,t.obj.position.z=-i.geometry.attributes.position.array[14]-t.size.z/2,i.update(),t.obj.rotation.z=0}},i.prototype.rotateLeft=function(e){var t=this.context,o=e||.01,n=t.camera.position.x,i=t.camera.position.z;t.camera.position.x=n*Math.cos(o)+i*Math.sin(o),t.camera.position.z=i*Math.cos(o)-n*Math.sin(o),t.camera.lookAt(t.scene.position)},t["a"]=i},"848b":function(e,t,o){"use strict";o.r(t);o("cadf"),o("551c"),o("f751"),o("097d");var n=o("2b0e"),i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"app"}},[o("HelloWorld")],1)},s=[],r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticStyle:{width:"200px",height:"200px"}},[o("model-view",{ref:"viewer",attrs:{"loading-img":e.loading,"background-color":"transparent",options:e.model_options}}),e.loadingSuccess?e._e():o("div",[e._v("加载中，请耐心等待..")]),e.loadingSuccess?o("div",{staticClass:"btn",class:{action:e.model_options.texture},on:{click:function(t){return e.texture()}}},[e._v("纹理")]):e._e(),e.loadingSuccess?o("div",{staticClass:"btn",class:{action:e.model_options.rotate},on:{click:function(t){return e.rotate()}}},[e._v("旋转")]):e._e(),e.loadingSuccess?o("div",{staticClass:"btn",class:{action:e.model_options.wire},on:{click:function(t){return e.wire()}}},[e._v("网格")]):e._e(),e.loadingSuccess?o("div",{staticClass:"btn",on:{click:function(t){return e.change()}}},[e._v("切换")]):e._e(),e.loadingSuccess?o("div",{staticClass:"btn",on:{click:function(t){return e.$refs.viewer.toFront()}}},[e._v("正面")]):e._e()],1)},a=[],c=(o("b99e"),{name:"HelloWorld",data:function(){return{model_options:{objUrl:"ring/stone1.obj",mtlUrl:"ring/stone1.mtl",texture:!0,wire:!1,rotate:!1,success:this.success},loading:void 0,loadingSuccess:!1}},methods:{texture:function(){this.model_options.texture=this.$refs.viewer.toggleTexture()},rotate:function(){this.model_options.rotate=this.$refs.viewer.toggleRotate()},wire:function(){this.model_options.wire=this.$refs.viewer.toggleWire()},change:function(){this.loadingSuccess=!1,"ring/ring1.obj"===this.model_options.objUrl?(this.model_options.mtlUrl="ring/stone1.mtl",this.model_options.objUrl="ring/stone1.obj"):(this.model_options.mtlUrl="ring/ring1.mtl",this.model_options.objUrl="ring/ring1.obj")},success:function(){this.loadingSuccess=!0}}}),l=c,u=(o("7ff8"),o("2877")),h=Object(u["a"])(l,r,a,!1,null,"34e51707",null),p=h.exports,d={name:"app",components:{HelloWorld:p}},g=d,f=(o("0d20"),Object(u["a"])(g,i,s,!1,null,null,null)),m=f.exports,b=(o("7f7f"),function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"c",staticStyle:{width:"100%",height:"100%",position:"relative"}},[o("div",{ref:"container",staticClass:"container",style:{background:e.backgroundColor},attrs:{id:e.options.objUrl}}),e.isLoadSuccess?e._e():o("img",{ref:"loadingImg",staticClass:"loading",attrs:{src:e.imageSrc}}),e.isLoadSuccess&&e.controller?o("div",{staticClass:"control"},[o("i",{staticClass:"iconfont icon-reset",on:{click:function(t){return e.toFront()}}}),o("i",{staticClass:"iconfont icon-rotate-obj",class:{action:e.settings.rotate},on:{click:function(t){return e.toggleRotate()}}}),o("i",{staticClass:"iconfont icon-texture",class:{action:e.settings.texture},on:{click:function(t){return e.toggleTexture()}}}),o("i",{staticClass:"iconfont icon-wire-earth",class:{action:e.settings.wire},on:{click:function(t){return e.toggleWire()}}})]):e._e()])}),v=[],w=o("bc99"),y=o("1401"),x=o("d875"),L={name:"model-view",created:function(){this.$threeViewer=new w["a"]},data:function(){return{isLoadSuccess:!1,imageSrc:this.loadingImg,settings:{rotate:this.options.rotate,texture:this.options.texture,wire:this.options.wire,success:this.options.success}}},props:{backgroundColor:{type:String,required:!1},options:{type:Object,required:!0},loadingImg:{type:String,required:!1},controller:{type:Boolean,default:!0,required:!1}},methods:{showModel:function(e){this.isLoadSuccess=!1;var t=this;this.$threeViewer.init({container:t.$refs.container,showTexture:t.settings.texture,showWire:t.settings.wire,rotate:t.settings.rotate,mesh:[{obj:e.objUrl||"",mtl:e.mtlUrl||""}],success:function(){y["a"].callFunc(t.settings.success),t.isLoadSuccess=!0}})},toFront:function(){this.$threeViewer.toFront()},toggleTexture:function(){return this.settings.texture=this.$threeViewer.toggleTexture(),this.settings.texture},toggleRotate:function(){return this.settings.rotate=this.$threeViewer.toggleRotate(),this.settings.rotate},toggleWire:function(){return this.settings.wire=this.$threeViewer.toggleWire(),this.settings.wire},resetView:function(){this.isLoadSuccess=!1,this.$threeViewer.destroy()}},mounted:function(){var e=this;function t(){e.$refs.loadingImg.style.cssText+="animation: rotate 2s 0s infinite linear;"}e.$refs.loadingImg.onerror=function(){e.imageSrc=x,t()},void 0===e.imageSrc&&(e.imageSrc=x,e.$refs.loadingImg.style.cssText+="animation: rotate 2s 0s infinite linear;",t()),window.console.log(this.$options._componentTag+" mounted"),this.showModel(this.options)},beforeDestroy:function(){window.console.log(this.$options._componentTag+" beforeDestroy"),this.resetView()},watch:{"options.objUrl":{handler:function(){var e=this;window.console.log("ModelView: model changed to:"),window.console.log(JSON.stringify(e.options,null,2)),e.showModel(e.options)}}}},M=L,k=(o("89ae"),o("349b"),Object(u["a"])(M,b,v,!1,null,"3058383d",null)),O=k.exports;O.install=function(e){e.component(O.name,O)};var j=O;n["a"].config.productionTip=!1,n["a"].use(j),new n["a"]({render:function(e){return e(m)}}).$mount("#app")},"89ae":function(e,t,o){"use strict";var n=o("f241"),i=o.n(n);i.a},"9d52":function(e,t,o){"use strict";o("ac6a"),o("673e"),o("f961");var n=o("5a89");n.TrackballControls=function(e,t){var o=this,i={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM:4,TOUCH_PAN:5};this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.noRoll=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.target=new n.Vector3;var s=1e-6,r=new n.Vector3,a=i.NONE,c=i.NONE,l=new n.Vector3,u=new n.Vector3,h=new n.Vector3,p=new n.Vector2,d=new n.Vector2,g=0,f=0,m=new n.Vector2,b=new n.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone();var v={type:"change"},w={type:"start"},y={type:"end"};function x(e){!1!==o.enabled&&(window.removeEventListener("keydown",x),c=a,a===i.NONE&&(e.keyCode!==o.keys[i.ROTATE]||o.noRotate?e.keyCode!==o.keys[i.ZOOM]||o.noZoom?e.keyCode!==o.keys[i.PAN]||o.noPan||(a=i.PAN):a=i.ZOOM:a=i.ROTATE))}function L(e){!1!==o.enabled&&(a=c,window.addEventListener("keydown",x,!1))}function M(e){!1!==o.enabled&&(e.preventDefault(),e.stopPropagation(),a===i.NONE&&(a=e.button),a!==i.ROTATE||o.noRotate?a!==i.ZOOM||o.noZoom?a!==i.PAN||o.noPan||(o.getMouseOnScreen(e.pageX,e.pageY,m),b.copy(m)):(o.getMouseOnScreen(e.pageX,e.pageY,p),d.copy(p)):(o.getMouseProjectionOnBall(e.pageX,e.pageY,u),h.copy(u)),document.addEventListener("mousemove",k,!1),document.addEventListener("mouseup",O,!1),o.dispatchEvent(w))}function k(e){!1!==o.enabled&&(e.preventDefault(),e.stopPropagation(),a!==i.ROTATE||o.noRotate?a!==i.ZOOM||o.noZoom?a!==i.PAN||o.noPan||o.getMouseOnScreen(e.pageX,e.pageY,b):o.getMouseOnScreen(e.pageX,e.pageY,d):o.getMouseProjectionOnBall(e.pageX,e.pageY,h))}function O(e){!1!==o.enabled&&(e.preventDefault(),e.stopPropagation(),a=i.NONE,document.removeEventListener("mousemove",k),document.removeEventListener("mouseup",O),o.dispatchEvent(y))}function j(e){if(!1!==o.enabled){e.preventDefault(),e.stopPropagation();var t=0;e.wheelDelta?t=e.wheelDelta/40:e.detail&&(t=-e.detail/3),p.y+=.01*t,o.dispatchEvent(w),o.dispatchEvent(y)}}function T(e){if(!1!==o.enabled){switch(e.touches.length){case 1:a=i.TOUCH_ROTATE,h.copy(o.getMouseProjectionOnBall(e.touches[0].pageX,e.touches[0].pageY,u));break;case 2:a=i.TOUCH_ZOOM;var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY;f=g=Math.sqrt(t*t+n*n);break;case 3:a=i.TOUCH_PAN,b.copy(o.getMouseOnScreen(e.touches[0].pageX,e.touches[0].pageY,m));break;default:a=i.NONE}o.dispatchEvent(w)}}function _(e){if(!1!==o.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:o.getMouseProjectionOnBall(e.touches[0].pageX,e.touches[0].pageY,h);break;case 2:var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY;f=Math.sqrt(t*t+n*n);break;case 3:o.getMouseOnScreen(e.touches[0].pageX,e.touches[0].pageY,b);break;default:a=i.NONE}}function S(e){if(!1!==o.enabled){switch(e.touches.length){case 1:u.copy(o.getMouseProjectionOnBall(e.touches[0].pageX,e.touches[0].pageY,h));break;case 2:g=f=0;break;case 3:m.copy(o.getMouseOnScreen(e.touches[0].pageX,e.touches[0].pageY,b));break}a=i.NONE,o.dispatchEvent(y)}}this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}},this.handleEvent=function(e){"function"==typeof this[e.type]&&this[e.type](e)},this.getMouseOnScreen=function(e,t,n){return n.set((e-o.screen.left)/o.screen.width,(t-o.screen.top)/o.screen.height)},this.getMouseProjectionOnBall=function(){var e=new n.Vector3,t=new n.Vector3;return function(n,i,s){t.set((n-.5*o.screen.width-o.screen.left)/(.5*o.screen.width),(.5*o.screen.height+o.screen.top-i)/(.5*o.screen.height),0);var r=t.length();return o.noRoll?r<Math.SQRT1_2?t.z=Math.sqrt(1-r*r):t.z=.5/r:r>1?t.normalize():t.z=Math.sqrt(1-r*r),l.copy(o.object.position).sub(o.target),s.copy(o.object.up).setLength(t.y),s.add(e.copy(o.object.up).cross(l).setLength(t.x)),s.add(l.setLength(t.z)),s}}(),this.rotateCamera=function(){var e=new n.Vector3,t=new n.Quaternion;return function(){var n=Math.acos(u.dot(h)/u.length()/h.length());n&&(e.crossVectors(u,h).normalize(),n*=o.rotateSpeed,t.setFromAxisAngle(e,-n),l.applyQuaternion(t),o.object.up.applyQuaternion(t),h.applyQuaternion(t),o.staticMoving?u.copy(h):(t.setFromAxisAngle(e,n*(o.dynamicDampingFactor-1)),u.applyQuaternion(t)))}}(),this.zoomCamera=function(){if(a===i.TOUCH_ZOOM){var e=g/f;g=f,l.multiplyScalar(e)}else{e=1+(d.y-p.y)*o.zoomSpeed;1!==e&&e>0&&(l.multiplyScalar(e),o.staticMoving?p.copy(d):p.y+=(d.y-p.y)*this.dynamicDampingFactor)}},this.panCamera=function(){var e=new n.Vector2,t=new n.Vector3,i=new n.Vector3;return function(){e.copy(b).sub(m),e.lengthSq()&&(e.multiplyScalar(l.length()*o.panSpeed),i.copy(l).cross(o.object.up).setLength(e.x),i.add(t.copy(o.object.up).setLength(e.y)),o.object.position.add(i),o.target.add(i),o.staticMoving?m.copy(b):m.add(e.subVectors(b,m).multiplyScalar(o.dynamicDampingFactor)))}}(),this.checkDistances=function(){o.noZoom&&o.noPan||(l.lengthSq()>o.maxDistance*o.maxDistance&&o.object.position.addVectors(o.target,l.setLength(o.maxDistance)),l.lengthSq()<o.minDistance*o.minDistance&&o.object.position.addVectors(o.target,l.setLength(o.minDistance)))},this.update=function(){l.subVectors(o.object.position,o.target),o.noRotate||o.rotateCamera(),o.noZoom||o.zoomCamera(),o.noPan||o.panCamera(),o.object.position.addVectors(o.target,l),o.checkDistances(),o.object.lookAt(o.target),r.distanceToSquared(o.object.position)>s&&(o.dispatchEvent(v),r.copy(o.object.position))},this.reset=function(){a=i.NONE,c=i.NONE,o.target.copy(o.target0),o.object.position.copy(o.position0),o.object.up.copy(o.up0),l.subVectors(o.object.position,o.target),o.object.lookAt(o.target),o.dispatchEvent(v),r.copy(o.object.position)},this.domElement.addEventListener("contextmenu",function(e){e.preventDefault()},!1),this.domElement.addEventListener("mousedown",M,!1),this.domElement.addEventListener("mousewheel",j,!1),this.domElement.addEventListener("DOMMouseScroll",j,!1),this.domElement.addEventListener("touchstart",T,!1),this.domElement.addEventListener("touchend",S,!1),this.domElement.addEventListener("touchmove",_,!1),window.addEventListener("keydown",x,!1),window.addEventListener("keyup",L,!1),this.handleResize(),this.update()},n.TrackballControls.prototype=Object.create(n.EventDispatcher.prototype),t["a"]=n.TrackballControls},a3e6:function(e,t,o){"use strict";(function(e){o("6b54");var n=o("9d52"),i=o("5a89");function s(){this.camera=null,this.scene=null,this.renderer=null,this.controls=null,this.pointLight=null,this.meshs={},this.settings={showTexture:!0,showWire:!0,rotate:!0}}s.prototype.init=function(e){Object.assign(this.settings,e),this.renderer=new i.WebGLRenderer({alpha:!0}),this.renderer.setSize(this.settings.container.clientWidth,this.settings.container.clientHeight),this.scene=new i.Scene,this.camera=new i.PerspectiveCamera(45,this.settings.container.clientWidth/this.settings.container.clientHeight,1,6e5),this.controls=new n["a"](this.camera,this.settings.container),this.controls.rotateSpeed=1,this.controls.zoomSpeed=1.2,this.controls.panSpeed=.2,this.controls.noZoom=!1,this.controls.noPan=!1,this.controls.staticMoving=!1,this.controls.dynamicDampingFactor=.3,this.controls.keys=[65,83,68];var t=new i.AmbientLight(14540253,.4);this.scene.add(t),this.pointLight=new i.PointLight,this.camera.add(this.pointLight),this.scene.add(this.camera),this.configPLight(),this.settings.container.innerHTML="",this.settings.container.appendChild(this.renderer.domElement)},s.prototype.getBasicMesh=function(){var e;for(var t in this.meshs)if(this.meshs[t].isBasic){e=this.meshs[t],e.key=t;break}return e},s.prototype.getBasicMesh=function(){var e;for(var t in this.meshs)if(this.meshs[t].isBasic){e=this.meshs[t],e.key=t;break}return e},s.prototype.url2key=function(t){return e.from(t).toString("base64")},s.prototype.key2url=function(t){return new e(t,"base64").toString()},s.prototype.meshKeys=function(){return Object.getOwnPropertyNames(this.meshs)},s.prototype.reset=function(){s.call(this)},s.prototype.traverseSupportMultiTexture=function(e,t){e&&e.traverse(function(e){if(e instanceof i.Mesh)if(e.material instanceof Array)for(var o in e.material)e.material[o]&&t(e.material[o]);else e.material&&t(e.material)})},s.prototype.configPLight=function(){var e=this,t=!1;for(var o in this.meshs)e.traverseSupportMultiTexture(e.meshs[o].obj,function(e){e.map&&(t=!0)});this.pointLight.color.set(this.settings.showTexture&&t?16777215:8947848),this.pointLight.intensity=.6},t["a"]=s}).call(this,o("b639").Buffer)},b99e:function(e,t,o){e.exports=o.p+"img/icon_3d.30c74037.png"},bc99:function(e,t,o){"use strict";(function(e){o("6b54");var n,i,s,r,a=o("f961"),c=o("a3e6"),l=o("541e"),u=o("28da"),h=o("80b8"),p=o("1401"),d=0;function g(){n=new c["a"],i=new u["a"](n),s=new h["a"](n)}function f(){n.settings.rotate&&s.rotateLeft(),n.controls.update(),n.renderer.render(n.scene,n.camera),d=requestAnimationFrame(f)}function m(e){for(var t in e)r.mixinTexture(e[t])}g.prototype.destroy=function(){for(var e in n.meshs)this.removeObj(n.key2url(e));console.log("cancel requestAnimationFrameId id:  "+d),cancelAnimationFrame(d),d=0,n.settings.container&&(n.settings.container.innerHTML=""),n.reset()},g.prototype.init=function(e){var t=this;a["a"].webgl||a["a"].addGetWebGLMessage(),t.destroy(),n.init(e),r=new l["a"](n,function(){if(n.settings.mesh&&n.settings.mesh instanceof Array)for(var e in n.settings.mesh)t.addObj(n.settings.mesh[e].obj,n.settings.mesh[e].mtl,{isBasic:0==e,success:0==e?n.settings.success:void 0});else p["a"].callFunc(n.settings.success)})},g.prototype.toFront=function(){s.bestLook()},g.prototype.toggleWire=function(){return n.settings.showWire=!n.settings.showWire,m(n.meshs),n.settings.showWire},g.prototype.toggleTexture=function(){return n.settings.showTexture=!n.settings.showTexture,m(n.meshs),n.settings.showTexture},g.prototype.toggleRotate=function(){return n.settings.rotate=!n.settings.rotate,n.settings.rotate},g.prototype.changeTexture=function(t,o){var s=e.from(t).toString("base64");s in n.meshs&&n.meshs[s].obj?i.loadMTL(o,function(e){n.meshs[s].textureMat=e,r.mixinTexture(n.meshs[s])}):console.log("模型 "+t+" 不存在")},g.prototype.addObj=function(e,t,o){void 0===o&&(o={isBasic:!1});var a=n.url2key(e),c=n.getBasicMesh();if(o.isBasic&&c&&c.key!==a)throw new Error("已有基础模型: "+n.key2url(c.key)+",不能再次添加基础模型: "+n.key2url(a));if(a in n.meshs&&n.meshs[a].obj)return n.meshs[a].hide?(console.log("模型 "+e+" 已成功加载过，使用内存数据"),n.meshs[a].hide=!1,r.mixinTexture(n.meshs[a]),void n.scene.add(n.meshs[a].obj)):void console.log("模型 "+e+" 已在渲染，无需重复添加");n.meshs[a]={isBasic:o.isBasic},i.loadOM(e,t,function(t){t.obj?(r.mixinTexture(t),t.isBasic=o.isBasic,n.meshs[n.url2key(e)]=t,n.scene.add(t.obj),(o.isBasic||1===n.meshKeys().length)&&(s.bestPosition(),s.bestLook()),n.configPLight(),!d&&f(),console.log("模型: "+e+" 加载成功"),p["a"].callFunc(o.success)):delete n.meshs[a]})},g.prototype.removeObj=function(e){var t=n.url2key(e);t in n.meshs?(n.scene.remove(n.meshs[t].obj),n.meshs[t].hide=!0,console.log("已移除模型: "+e)):console.log("渲染列表无此模型: "+e+"，无需删除")},t["a"]=g}).call(this,o("b639").Buffer)},d875:function(e,t,o){e.exports=o.p+"img/loading.8a62509b.png"},dfa5:function(e,t,o){},ebc3:function(e,t,o){"use strict";o.r(t);o("28a5");var n=o("5a89");n.MTLLoader=function(e,t,o){this.baseUrl=e,this.options=t,this.crossOrigin=o},n.MTLLoader.prototype={constructor:n.MTLLoader,load:function(e,t){var o=this,i=new n.XHRLoader;i.load(e,function(e){t(o.parse(e))})},parse:function(e){for(var t=e.split("\n"),o={},i=/\s+/,s={},r=0;r<t.length;r++){var a=t[r];if(a=a.trim(),0!==a.length&&"#"!==a.charAt(0)){var c=a.indexOf(" "),l=c>=0?a.substring(0,c):a;l=l.toLowerCase();var u=c>=0?a.substring(c+1):"";if(u=u.trim(),"newmtl"===l)o={name:u},s[u]=o;else if(o)if("ka"===l||"kd"===l||"ks"===l){var h=u.split(i,3);o[l]=[parseFloat(h[0]),parseFloat(h[1]),parseFloat(h[2])]}else o[l]=u}}var p=new n.MTLLoader.MaterialCreator(this.baseUrl,this.options);return p.setMaterials(s),p}},n.MTLLoader.MaterialCreator=function(e,t){this.baseUrl=e,this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:n.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:n.RepeatWrapping},n.MTLLoader.MaterialCreator.prototype={constructor:n.MTLLoader.MaterialCreator,setMaterials:function(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(e){if(!this.options)return e;var t={};for(var o in e){var n=e[o],i={};for(var s in t[o]=i,n){var r=!0,a=n[s],c=s.toLowerCase();switch(c){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(a=[a[0]/255,a[1]/255,a[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===a[0]&&0===a[1]&&0===a[1]&&(r=!1);break;case"d":this.options&&this.options.invertTransparency&&(a=1-a);break;default:break}r&&(i[c]=a)}}return t},preload:function(){for(var e in this.materialsInfo)this.create(e)},getIndex:function(e){return this.nameLookup[e]},getAsArray:function(){var e=0;for(var t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray},create:function(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]},createMaterial_:function(e){var t=this.materialsInfo[e],o={name:e,side:this.side};for(var i in t){var s=t[i];switch(i.toLowerCase()){case"kd":o["diffuse"]=(new n.Color).fromArray(s);break;case"ka":o["ambient"]=(new n.Color).fromArray(s);break;case"ks":o["specular"]=(new n.Color).fromArray(s);break;case"map_kd":o["map"]=this.loadTexture(this.baseUrl+s),o["map"].wrapS=this.wrap,o["map"].wrapT=this.wrap;break;case"ns":o["shininess"]=s;break;case"d":s<1&&(o["transparent"]=!0,o["opacity"]=s);break;default:break}}return o["diffuse"]&&(o["ambient"]||(o["ambient"]=o["diffuse"]),o["color"]=o["diffuse"]),this.materials[e]=new n.MeshPhongMaterial(o),this.materials[e]},loadTexture:function(e,t,o){var i,s=n.Loader.Handlers.get(e);return null!==s?i=s.load(e,o):(i=new n.Texture,s=new n.ImageLoader,s.crossOrigin=this.crossOrigin,s.load(e,function(e){i.image=n.MTLLoader.ensurePowerOfTwo_(e),i.needsUpdate=!0,o&&o(i)})),i.mapping=t,i}},n.MTLLoader.ensurePowerOfTwo_=function(e){if(!n.Math.isPowerOfTwo(e.width)||!n.Math.isPowerOfTwo(e.height)){var t=document.createElement("canvas");t.width=n.MTLLoader.nextHighestPowerOfTwo_(e.width),t.height=n.MTLLoader.nextHighestPowerOfTwo_(e.height);var o=t.getContext("2d");return o.drawImage(e,0,0,e.width,e.height,0,0,t.width,t.height),t}return e},n.MTLLoader.nextHighestPowerOfTwo_=function(e){--e;for(var t=1;t<32;t<<=1)e|=e>>t;return e+1}},f241:function(e,t,o){},f961:function(e,t,o){"use strict";var n={canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{var e=document.createElement("canvas");return!!window.WebGLRenderingContext&&(e.getContext("webgl")||e.getContext("experimental-webgl"))}catch(t){return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var e=document.createElement("div");return e.id="webgl-error-message",e.style.fontFamily="monospace",e.style.fontSize="13px",e.style.fontWeight="normal",e.style.textAlign="center",e.style.background="#fff",e.style.color="#000",e.style.padding="1.5em",e.style.width="400px",e.style.margin="5em auto 0",this.webgl||(e.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n"):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n")),e},addGetWebGLMessage:function(e){var t,o,i;e=e||{},t=void 0!==e.parent?e.parent:document.body,o=void 0!==e.id?e.id:"oldie",i=n.getWebGLErrorMessage(),i.id=o,t.appendChild(i)}};t["a"]=n}});
//# sourceMappingURL=demo.6ab8e7f8.js.map